<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Liste des fonctions</title>

	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.1/css/bulma.min.css">
</head>

<body onload="get_functions()" class="has-background-light">
	<section class="section pt-0">
		<div class="container is-fullhd">
			<div class="notification is-light is-flex is-justify-content-space-between has-background-dark">
				<h1 class="is-unselectable has-text-white">PHP Functions</h1>
				<a class="button is-small is-warning" href="create">
                    <span class="icon is-small"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-11a1 1 0 10-2 0v2H7a1 1 0 100 2h2v2a1 1 0 102 0v-2h2a1 1 0 100-2h-2V7z" clip-rule="evenodd"></path></svg></span>
                    <span>Cr√©er une fonction</span>
                </a>
			</div>
			<table class="table is-fullwidth is-hidden has-background-light">
				<thead>
					<tr>
						<th>Nom de la fonction</th>
						<th>URL</th>
						<th>Actions</th>
					</tr>
				</thead>
				<tbody></tbody>
			</table>
		</div>
	</section>


	<script>
		function get_functions() {
            const owner = "public";
            
            fetch(`https://mende.alwaysdata.net/funcs/${owner}/functions`)
            .then(res => {
                return res.json();
            }).then(res => {
                document.querySelector("table").classList.toggle("is-hidden");
                const listEl = document.querySelector("tbody");
                res.funcs.forEach(func => {
                    listEl.innerHTML += `<tr>
                        <th><a href="edit?url=${func.url}">${func.name}</a></th>
						<th><a href="${func.url}" title="Cliquez pour la tester" target="_blank" class="has-text-grey is-family-code has-text-weight-light is-size-7">${func.url}</a></th>
						<td>
							<div class="buttons are-small">
								<a href="edit?url=${func.url}" class="button is-primary">
                                    <span class="icon is-small"><svg class="w-6 h-6" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path></svg></span>
                                    <span>Modifier</span>
                                </a>
							</div>
						</td>
					</tr>`;
                })
            }).catch(err => {
                console.error(err)
            })
        }
        
	</script>
</body>

</html>